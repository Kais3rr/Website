<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dull | Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&display=swap" rel="stylesheet">
    <style>
        /* Cursor and Base Styles */
        * { cursor: none !important; }
        
        html, body {
            background-color: #050505;
            font-family: "DM Mono", monospace;
            color: white;
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden; 
            -webkit-font-smoothing: antialiased;
        }

        #page-wrapper {
            height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        #page-wrapper::-webkit-scrollbar { display: none; }
        #page-wrapper { -ms-overflow-style: none; scrollbar-width: none; }

        .CustomCursor {
            position: fixed;
            width: 20px;
            height: 20px;
            border: 2px solid #3b82f6;
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 200000;
            transition: transform 0.1s ease-out;
            background: rgba(59, 130, 246, 0.1);
        }

        #rain-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; pointer-events: none; opacity: 0.3;
        }

        .Main { 
            max-width: 1200px; 
            margin: 0 auto;
            padding: 7vh 5vw; 
            position: relative; 
            z-index: 10; 
        }

        @keyframes neonRotate {
            0% { border-color: #3b82f6; box-shadow: 0 0 10px rgba(59, 130, 246, 0.1); }
            50% { border-color: #a855f7; box-shadow: 0 0 10px rgba(168, 85, 247, 0.1); }
            100% { border-color: #3b82f6; box-shadow: 0 0 10px rgba(59, 130, 246, 0.1); }
        }

        /* Distinct Outlined Container for Scrolling Sections */
        .ScrollZone {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 32px;
            padding: 32px;
            position: relative;
            backdrop-filter: blur(10px);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
            transition: border-color 0.3s ease;
        }
        
        .ScrollZone:hover {
            border-color: rgba(168, 85, 247, 0.4);
        }

        .ProjectContainer {
            flex: 0 0 280px;
            display: flex;
            flex-direction: column;
            border-radius: 16px;
            background-color: #0d0d0d;
            padding: 16px;
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            text-decoration: none;
            color: #a3a3a3;
            border: 1.5px solid #3b82f6;
            animation: neonRotate 6s linear infinite;
            flex-shrink: 0;
            overflow: hidden;
            cursor: pointer;
        }

        .ProjectContainer:hover {
            transform: translateY(-5px);
            color: white;
            border-color: white;
        }

        .VisualHeader {
            width: 100%;
            aspect-ratio: 1/1;
            border-radius: 12px;
            object-fit: cover;
            margin-bottom: 16px;
            background: #111;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .VFXThumbnail { aspect-ratio: 16/9; }

        .Separator {
            height: 1px;
            background: linear-gradient(90deg, #3b82f6, #a855f7, #3b82f6);
            background-size: 200% 100%;
            animation: sepAnim 5s linear infinite;
            margin: 30px 0;
        }
        @keyframes sepAnim { 0% { background-position: 0% 0%; } 100% { background-position: 200% 0%; } }

        .ScrollContainer {
            display: flex;
            overflow-x: auto;
            gap: 24px;
            padding: 10px 5px 20px 5px;
            scrollbar-width: none;
            -ms-overflow-style: none;
            scroll-behavior: smooth;
        }
        .ScrollContainer::-webkit-scrollbar { display: none; }

        .StatValue { color: white; font-size: 3rem; font-weight: 500; letter-spacing: -1.5px; }

        /* Modal Styles */
        #vfx-modal {
            position: fixed;
            inset: 0;
            z-index: 100000;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(12px);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 30px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #vfx-modal.active { display: flex; opacity: 1; }

        .ModalContent {
            background: #0a0a0a;
            border: 1px solid rgba(59, 130, 246, 0.5);
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 85vh;
            overflow: hidden;
            position: relative;
        }

        .CloseBtn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 110;
        }

        .ModalVideo {
            width: 100%;
            aspect-ratio: 16/9;
            background: black;
            display: block;
        }

        .ModalBody { padding: 25px; overflow-y: auto; max-height: 30vh; }

        #main-mask {
            position: fixed; inset: 0; pointer-events: none; z-index: 50;
            background: linear-gradient(to bottom, #050505 0%, transparent 5%, transparent 95%, #050505 100%);
        }
    </style>
</head>
<body>

    <div class="CustomCursor" id="cursor"></div>
    <div id="main-mask"></div>
    <canvas id="rain-canvas"></canvas>

    <div id="page-wrapper">
        <!-- VFX Modal -->
        <div id="vfx-modal" onclick="closeVfxModal(event)">
            <div class="ModalContent" onclick="event.stopPropagation()">
                <button class="CloseBtn" onclick="closeVfxModal()">âœ•</button>
                <video id="modal-video" controls class="ModalVideo"></video>
                <div class="ModalBody">
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-[8px] bg-blue-500/10 text-blue-400 px-3 py-1 rounded-full font-bold uppercase tracking-widest border border-blue-500/20">System Production</span>
                        <span class="text-[9px] text-white/40 font-mono" id="modal-views">0 VIEWS</span>
                    </div>
                    <h2 id="modal-title" class="text-xl font-bold mb-2">Project Title</h2>
                    <p id="modal-description" class="text-white/50 leading-relaxed text-xs font-light"></p>
                </div>
            </div>
        </div>

        <main class="Main">
            <header class="mb-16">
                <h1 class="text-5xl font-bold tracking-tight">Dull</h1>
                <p class="opacity-40 mt-3 text-[10px] uppercase tracking-[0.4em]">VFX Designer</p>
                <div class="Separator"></div>
            </header>

            <!-- Statistics Section -->
            <section class="mb-24">
                <h2 class="text-[9px] uppercase tracking-[0.4em] mb-8 opacity-30">Statistics</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-[#0a0a0a] border border-white/5 rounded-[24px] text-center p-10">
                        <div class="text-[9px] uppercase tracking-[0.3em] mb-2 opacity-40">Contributions</div>
                        <div class="StatValue" id="game-counter">0</div>
                    </div>
                    <div class="bg-[#0a0a0a] border border-white/5 rounded-[24px] text-center p-10">
                        <div class="text-[9px] uppercase tracking-[0.3em] mb-2 opacity-40">Contributed Visits</div>
                        <div class="StatValue" id="visit-counter">0</div>
                    </div>
                </div>
            </section>

            <!-- Contributions Section -->
            <section class="mb-24">
                <h2 class="text-[9px] uppercase tracking-[0.4em] mb-6 opacity-30">Contributions</h2>
                <div class="ScrollZone">
                    <div id="games-grid" class="ScrollContainer"></div>
                </div>
            </section>

            <!-- Showcase Section -->
            <section class="mb-24">
                <h2 class="text-[9px] uppercase tracking-[0.4em] mb-6 opacity-30">Showcase</h2>
                <div class="ScrollZone">
                    <div id="projects-grid" class="ScrollContainer"></div>
                </div>
            </section>

            <footer class="mt-32 opacity-20 text-[8px] tracking-[0.5em] uppercase text-center pb-16">
                <p>&copy; 2025-26 DULL &bull;</p>
            </footer>
        </main>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, increment, onSnapshot } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'kaizer-portfolio';

        const vfxProjects = [
            { id: "vfx_lightning", title: "Lightning Aura v2", description: "Advanced GPU-accelerated particle system with dynamic branching.", thumbUrl: "https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-abstract-blue-waves-and-lines-background-27361-large.mp4" },
            { id: "vfx_impact", title: "Procedural Impact", description: "Environment-aware shockwave distortion and terrain deformation.", thumbUrl: "https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=800", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-software-developer-working-on-his-laptop-34444-large.mp4" },
            { id: "vfx_node", title: "Skill Node Framework", description: "Modular VFX triggering and optimized cleanup system.", thumbUrl: "https://images.unsplash.com/photo-1534447677768-be436bb09401?w=800", videoUrl: "https://assets.mixkit.co/videos/preview/mixkit-close-up-of-a-person-typing-on-a-keyboard-34442-large.mp4" }
        ];

        const featuredGames = [
            { id: "77021749781226", title: "Blue Lock: Skibidi", role: "Contributor", link: "https://www.roblox.com/games/77021749781226" }
        ];

        async function init() {
            await signInAnonymously(auth);
            renderGames();
            renderVFX();
            initRain();
            drawRain();
            initDashboard();
        }

        function renderVFX() {
            const grid = document.getElementById('projects-grid');
            grid.innerHTML = vfxProjects.map(vfx => `
                <div class="ProjectContainer" onclick="openVfxModal('${vfx.id}')">
                    <img src="${vfx.thumbUrl}" class="VisualHeader VFXThumbnail" alt="${vfx.title}">
                    <div class="flex justify-between items-start mb-1">
                        <h3 class="text-white font-semibold text-sm">${vfx.title}</h3>
                        <div class="text-[8px] text-blue-400 font-bold opacity-80" id="card-views-${vfx.id}">...</div>
                    </div>
                </div>
            `).join('');
            
            vfxProjects.forEach(vfx => {
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'vfx_views', vfx.id);
                onSnapshot(docRef, (snap) => {
                    const count = snap.exists() ? snap.data().count : 0;
                    const el = document.getElementById(`card-views-${vfx.id}`);
                    if (el) el.innerText = count.toLocaleString() + " VIEWS";
                });
            });
            setupSmoothHorizontalScroll(grid);
        }

        window.openVfxModal = async function(id) {
            const vfx = vfxProjects.find(v => v.id === id);
            if (!vfx) return;
            const modal = document.getElementById('vfx-modal');
            const video = document.getElementById('modal-video');
            document.getElementById('modal-title').innerText = vfx.title;
            document.getElementById('modal-description').innerText = vfx.description;
            video.src = vfx.videoUrl;
            modal.classList.add('active');
            video.play();

            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'vfx_views', id);
            const snap = await getDoc(docRef);
            if (!snap.exists()) {
                await setDoc(docRef, { count: 1 });
            } else {
                await updateDoc(docRef, { count: increment(1) });
            }
        };

        window.closeVfxModal = function() {
            const modal = document.getElementById('vfx-modal');
            const video = document.getElementById('modal-video');
            modal.classList.remove('active');
            video.pause();
        };

        function renderGames() {
            const grid = document.getElementById('games-grid');
            grid.innerHTML = featuredGames.map(game => `
                <a href="${game.link}" target="_blank" class="ProjectContainer">
                    <img src="https://tr.rbxcdn.com/30DAY-PlaceHolder-600x600-Png/150/150/Image/Png" id="icon-${game.id}" class="VisualHeader">
                    <div class="flex justify-between items-center mt-auto">
                        <h3 class="text-white font-semibold text-sm">${game.title}</h3>
                        <span class="text-[8px] border border-blue-500/30 text-blue-400 px-2 py-0.5 rounded uppercase font-bold">${game.role}</span>
                    </div>
                    <div class="text-[9px] font-mono text-white/40 mt-1" id="visits-${game.id}">0 Visits</div>
                </a>
            `).join('');
            setupSmoothHorizontalScroll(grid);
        }

        function setupSmoothHorizontalScroll(container) {
            container.addEventListener('wheel', (e) => {
                if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
                    e.preventDefault();
                    container.scrollLeft += e.deltaY * 1.5;
                }
            }, { passive: false });
        }

        async function initDashboard() {
            let totalV = 0;
            for (const game of featuredGames) {
                try {
                    // 1. Get UniverseId from PlaceId
                    const uRes = await fetch(`https://apis.roproxy.com/universes/v1/places/${game.id}/universe`);
                    const { universeId } = await uRes.json();
                    
                    // 2. Get Game Info (Visits) from UniverseId
                    const gRes = await fetch(`https://games.roproxy.com/v1/games?universeIds=${universeId}`);
                    const { data } = await gRes.json();
                    
                    // 3. Get High-Res Icon
                    const iconRes = await fetch(`https://thumbnails.roproxy.com/v1/games/icons?universeIds=${universeId}&returnPolicy=PlaceHolder&size=420x420&format=Png&isCircular=false`);
                    const iconData = await iconRes.json();
                    
                    if (data && data[0]) {
                        totalV += data[0].visits;
                        document.getElementById(`visits-${game.id}`).innerText = data[0].visits.toLocaleString() + " Visits";
                    }
                    if (iconData && iconData.data && iconData.data[0]) {
                        document.getElementById(`icon-${game.id}`).src = iconData.data[0].imageUrl;
                    }
                } catch(e) { console.error("API error", e); }
            }
            animateCounter('game-counter', featuredGames.length);
            animateCounter('visit-counter', totalV, "+");
        }

        function animateCounter(id, target, suffix = "") {
            const el = document.getElementById(id);
            if (!el) return;
            let current = 0;
            const start = performance.now();
            function step(t) {
                const prog = Math.min((t - start) / 2000, 1);
                current = Math.floor((1 - Math.pow(2, -10 * prog)) * target);
                el.innerText = current.toLocaleString() + suffix;
                if (prog < 1) requestAnimationFrame(step);
            }
            requestAnimationFrame(step);
        }

        const cursor = document.getElementById('cursor');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
        });

        const canvas = document.getElementById('rain-canvas');
        const ctx = canvas.getContext('2d');
        let drops = [];
        function initRain() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            drops = Array(80).fill().map(() => ({ 
                x: Math.random() * canvas.width, 
                y: Math.random() * canvas.height, 
                len: Math.random() * 20 + 10, 
                v: Math.random() * 5 + 5 
            }));
        }
        function drawRain() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = 'rgba(59, 130, 246, 0.1)';
            drops.forEach(d => {
                ctx.beginPath(); ctx.moveTo(d.x, d.y); ctx.lineTo(d.x, d.y + d.len); ctx.stroke();
                d.y += d.v; if (d.y > canvas.height) d.y = -d.len;
            });
            requestAnimationFrame(drawRain);
        }

        init();
        window.addEventListener('resize', initRain);
    </script>
</body>
</html>
